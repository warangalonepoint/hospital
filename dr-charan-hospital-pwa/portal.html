<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Patient Portal â€“ Dr. Charan Hospital</title>
  <link rel="manifest" href="manifest.webmanifest"/><link rel="icon" href="assets/logo.png"/>
  <link rel="stylesheet" href="styles.css?v=5"/>
</head>
<body>
  <header class="banner">
    <div class="brand">
      <img src="assets/logo.png" alt="Logo">
      <div>
        <h1 class="title">Dr. Charan Hospital</h1>
        <p class="subtitle">Patient Portal</p>
      </div>
    </div>
    <button id="themeToggle" class="chip">ðŸŒ™</button>
  </header>

  <main class="container narrow">
    <section class="card">
      <div class="field"><label>Contact (10-digit)</label><input id="contact" inputmode="tel"/></div>
      <div class="field"><label>PIN</label><input id="ppin" placeholder="2222"/></div>
      <button class="btn" id="load">View My Records</button>
    </section>
    <section class="card" id="list" hidden>
      <h3>My Appointments & Notes</h3>
      <div class="table-wrap">
        <table class="table" id="ptbl"><thead><tr><th>Date</th><th>Time</th><th>Diagnosis</th></tr></thead><tbody></tbody></table>
      </div>
    </section>
  </main>

  <footer class="footer">Demo portal â€¢ read-only</footer>
  <script type="module">
    const tbtn=document.getElementById('themeToggle');
    if(localStorage.theme){ document.documentElement.setAttribute('data-theme', localStorage.theme); tbtn.textContent = localStorage.theme==='light'?'ðŸŒž':'ðŸŒ™'; }
    tbtn.onclick=()=>{ const cur=document.documentElement.getAttribute('data-theme'); const next=cur==='light'?'dark':'light'; document.documentElement.setAttribute('data-theme',next); localStorage.theme=next; tbtn.textContent=next==='light'?'ðŸŒž':'ðŸŒ™'; };

    import { recordsForContact } from './js/store.js?v=5';
    const btn=document.getElementById('load'), list=document.getElementById('list'), tbody=document.querySelector('#ptbl tbody');
    btn.onclick=()=>{ const c=document.getElementById('contact').value.trim(); const p=document.getElementById('ppin').value.trim();
      if(p!=='2222'){ alert('Invalid PIN'); return; }
      const rows=recordsForContact(c); tbody.innerHTML='';
      for(const r of rows){ const tr=document.createElement('tr'); tr.innerHTML=`<td>${r.date}</td><td>${r.slot}</td><td>${r.dx}</td>`; tbody.appendChild(tr); }
      list.hidden=false;
    };
  </script>
</body>
</html>
