<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard â€“ Dr. Charan Hospital</title>
  <link rel="manifest" href="manifest.webmanifest"/>
  <link rel="stylesheet" href="styles.css?v=10"/>
</head>
<body>
  <!-- Banner already has logo+title inside the image -->
  <header class="banner clean"></header>
  <button id="themeToggle" class="chip floating-toggle">ðŸŒ™</button>

  <main class="container n8">
    <!-- Big tile menu -->
    <section class="card">
      <div class="tile-grid">
        <a class="tile analytics" id="openAnalytics"><div class="title">Analytics</div><div class="sub">KPIs & weekly sales</div></a>
        <a class="tile pharma" id="openPharmacy"><div class="title">Pharmacy</div><div class="sub">Sales & invoices</div></a>
        <a class="tile bookings" id="openBookings"><div class="title">Bookings</div><div class="sub">Quick patient slots</div></a>
        <a class="tile patients" id="openPatients"><div class="title">Patients</div><div class="sub">Reminders & history</div></a>
        <a class="tile staff" id="openStaff"><div class="title">Staff</div><div class="sub">Roster & status</div></a>
        <a class="tile upload" id="openUpload"><div class="title">Data Upload</div><div class="sub">5 years CSV import</div></a>
      </div>
      <div style="display:flex;gap:10px;margin-top:14px;">
        <button id="logout" class="btn">Logout</button>
        <button id="clearCacheBtn" class="btn">Clear Cache</button>
      </div>
    </section>
    <section class="card" id="analyticsPanel">
      <h3 style="margin-top:0">Sales Analytics</h3>
      <div class="tile-grid" style="grid-template-columns:repeat(3,1fr);">
        <div class="stat"><div class="num" id="totalToday">0</div><div class="lbl">Today â‚¹</div></div>
        <div class="stat"><div class="num" id="totalMonth">0</div><div class="lbl">This Month â‚¹</div></div>
        <div class="stat"><div class="num" id="topItem">â€“</div><div class="lbl">Top Item</div></div>
      </div>
      <canvas id="salesChart" height="180" style="width:100%;margin-top:16px"></canvas>
    </section>
  </main>

  <footer style="text-align:center;color:var(--muted);margin:20px 0 40px">
    Role-based demo â€¢ Doctor has full access
  </footer>

  <script type="module">
    import * as S from './js/store.js?v=5';
    const tbtn=document.getElementById('themeToggle');
    if(localStorage.theme){document.documentElement.setAttribute('data-theme',localStorage.theme);tbtn.textContent=localStorage.theme==='light'?'ðŸŒž':'ðŸŒ™';}
    tbtn.onclick=()=>{const cur=document.documentElement.getAttribute('data-theme')||'light';const next=cur==='light'?'dark':'light';document.documentElement.setAttribute('data-theme',next);localStorage.theme=next;tbtn.textContent=next==='light'?'ðŸŒž':'ðŸŒ™';};
    const u=(JSON.parse(localStorage.getItem('onestop_hospital_demo_v10')||'{}')).user;if(!u)location.href='login.html?v=10';
    document.getElementById('logout').onclick=()=>{localStorage.setItem('onestop_hospital_demo_v10',JSON.stringify({user:null}));location.href='login.html?v=10';};
    document.getElementById('clearCacheBtn').onclick=async()=>{localStorage.clear();if('caches'in window){const ks=await caches.keys();await Promise.all(ks.map(k=>caches.delete(k)));}if('serviceWorker'in navigator){const rs=await navigator.serviceWorker.getRegistrations();for(const r of rs)await r.unregister();}alert("Cache cleared. Reloadingâ€¦");location.reload(true);};
  </script>
</body>
</html>
