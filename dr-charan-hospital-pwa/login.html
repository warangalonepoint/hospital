<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Login â€“ Dr. Charan Hospital</title>
  <link rel="manifest" href="manifest.webmanifest"/>
  <link rel="icon" href="assets/logo.png"/>
  <link rel="stylesheet" href="styles.css?v=5"/>
</head>
<body>
  <header class="banner">
    <div class="brand">
      <img src="assets/logo.png" alt="Logo">
      <div>
        <h1 class="title">Dr. Charan Hospital</h1>
        <p class="subtitle">Login</p>
      </div>
    </div>
    <button id="themeToggle" class="chip">ðŸŒ™</button>
  </header>

  <main class="container narrow">
    <section class="card">
      <div class="field">
        <label>Role</label>
        <select id="role">
          <option value="doctor">Doctor</option>
          <option value="supervisor">Supervisor</option>
          <option value="patient">Patient</option>
        </select>
      </div>
      <div class="field">
        <label>PIN</label>
        <input id="pin" inputmode="numeric" maxlength="6" placeholder="4-digit"/>
      </div>
      <button class="btn" id="loginBtn">Login</button>
      <p>Demo PINs â†’ Doctor: <b>4321</b> â€¢ Supervisor: <b>1111</b> â€¢ Patient: <b>2222</b></p>
    </section>
  </main>

  <footer class="footer">PWA Demo â€¢ Works offline</footer>

  <script>
    // Theme toggle
    const tbtn=document.getElementById('themeToggle');
    if(localStorage.theme){ document.documentElement.setAttribute('data-theme', localStorage.theme); tbtn.textContent = localStorage.theme==='light'?'ðŸŒž':'ðŸŒ™'; }
    tbtn.onclick=()=>{ const cur=document.documentElement.getAttribute('data-theme'); const next=cur==='light'?'dark':'light'; document.documentElement.setAttribute('data-theme',next); localStorage.theme=next; tbtn.textContent=next==='light'?'ðŸŒž':'ðŸŒ™'; };

    // Inline login â€“ no external deps
    const USERS=[{role:'doctor',pin:'4321',name:'Dr. Rao'},{role:'supervisor',pin:'1111',name:'Supervisor'},{role:'patient',pin:'2222',name:'Patient'}];
    const KEY='onestop_hospital_demo_v5';
    function base(){return {bookings:[],slots:{},sales:[],patients:[],roster:[],user:null}}
    function saveUser(u){ const db=JSON.parse(localStorage.getItem(KEY)||JSON.stringify(base())); db.user={role:u.role,name:u.name}; localStorage.setItem(KEY,JSON.stringify(db)); }
    document.getElementById('loginBtn').onclick=()=>{ const role=document.getElementById('role').value; const pin=document.getElementById('pin').value.trim(); const u=USERS.find(x=>x.role===role&&x.pin===pin); if(!u){alert('Invalid PIN');return;} saveUser(u); location.href= role==='patient' ? 'portal.html?v=5' : 'dashboard.html?v=5'; };

    if('serviceWorker' in navigator){ navigator.serviceWorker.register('service-worker.js'); }
  </script>
</body>
</html>
